#### 

HLA-A vs.  HLA-DRB1

http://atlasgeneticsoncology.org/Genes/GC_HLA-A.html
Starts at 29942470 and ends at 29945884 bp from pter ( according to hg38-Dec_2013)
http://atlasgeneticsoncology.org/Genes/GC_HLA-DRB1.html
Starts at 32578770 and ends at 32589836 bp from pter ( according to hg38-Dec_2013)


HLA-A, chrom6, 29942470:29945884


HLA-DRB1, chrom6, 32578770:32589836



R```

library(BSgenome.Hsapiens.UCSC.hg38)
genome <- BSgenome.Hsapiens.UCSC.hg38
chrom6 = genome$chr6

HLA_A = chrom6[29942470:29945884]

HLA_DRB1 = chrom6[32578770:32589836]

> HLA_A
  3415-letter "DNAString" instance
seq: GAGAAGCCAATCAGTGTCGTCGCGGTCGCTGTTCTA...AAATAAATGGAAGACATGAGAACCTTCCAGAGTCCA

> HLA_DRB1
  11067-letter "DNAString" instance
seq: TTAACTCCATCTTTGAGAAACATTTAATAATGTAAT...ACTATGAACCCCTCCACCCACATTCCAAGTTATAGG
> 


```

-bash:mskilab01:~/vg_test_VCF_original/MHC_LRC_pruning 1011 $ module load samtools/1.6
-bash:mskilab01:~/vg_test_VCF_original/MHC_LRC_pruning 1012 $ samtools faidx chr6_HLA_A_GRCh38.fa
-bash:mskilab01:~/vg_test_VCF_original/MHC_LRC_pruning 1013 $ samtools faidx  chr6_HLA_DRB1_GRCh38.fa


```R
library(gUtils)
library(skidb)
foo = read_vcf('chr6.vcf')

HLA_A = foo  %&% GRanges('chr6:29942470-29945884')

HLA_DRB1 = foo  %&% GRanges('chr6:32578770-32589836')
```


chr6	29716427	.	C	T	.	PASS	.
chr6	29716631	.	TTTAATTTTGC	T	.	PASS	.
chr6	29716668	.	A	AATTC	.	PASS	.
chr6	29717500	.	T	C	.	PASS	.
chr6	29717692	.	CAAAAGAAAGACCCAAGCCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCCCGTCTCCCTCTCCCTCTCATGCCGAGCCAAAGCTGGACGGTACTGCTGCCATCTCGGCTCACTGCAACCTCCCTGCCTGATTCTCCTGCCTCAGCCTGCCGAGTGCCTGCGATTGCAGGCGCGCGCCGCCACGCCTGACTGGTTTTCGTTTTTTTTTGGTGGAGATGGGGTTTCGCTGTGTTGGCCGGGCTGGTCTCCAGCTCCTAACCGCGAGTGATCCGCCAGCCTCGGCCTCCCGAGGTGCCGGGATTGCAGATGGAGTCTCGTTCACTCAGTGCTCAATGGTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCGGCTCGCTACAACCACCTCCCAGCCGCCTGCCTTGGCCTCCCAAGGAGCCGAGATTGCAGCCTCTGCCCGGCCGCCACCCCGTCTGGGAAGTGAGGAGCGTCTCTGCTTGGCCACCCATCGTCTGGGATATGAGGAGCCCCTCTGCCTGGCTGCCCAGTGTGGAAAGTGGGGAGCGTCTCTGCCCGGCCGCCATCCCATCTAGGAAGCGAGAAGCGCCTCTTCCCCGCCGCCATCCCATCTAGGAAGTGAGGAGCGTCTCTGCCCGGCCGCCCATCGTCTGAGATGTGGGGAGCACCTCTGCCCCACCGCCCTGTCTGGGATGTGAGGAGCGCCTCTGCTGGGCCGCGGCCCTGTCTGGGAGGTGAGGAGTGTCTCTGCCCGGCCGCTCCGTCTGAGAAGTGAGGAAACCCTCTGCCTGGCAACCGCCCCGTCTGAGAAGTGAGGAGCCCCTCCGTCTGGCAACCACCCCGTCTGGGAAGTGAGGAGCGTCTCCGCCCGGCAGCCACCCCGTCCGGGAGGGAGGTGGGGGGGGTCAGCCCCCCGCCCGGCCAGCCGCCCCGTCCGGGAGGTGAGGGGCTCCTCTGCCCGGCCGCCCCTACTGGGAAGTGAGGAGCCCCTCTGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGCGGGGGGGGGGGGGTCGGCCAGCCGCCCCGGCCGGGAGGTGAGGGGCTCCTCTGCCCGGCCGCCCCTACTGGGAAGTGAGGAGCCCCTCTGCCCGGCCAGTCGCCCCGTCCAGGAGGGAGGTGGGGGGGTCAACCCCCCGCCCGGCCAGCCGCCCAGTCCGGGAGGGAGGTGGGGGGTCAGCCCCCCGCCCGGCCAGCCGCCCCGTCCGGGAGGGGGGAGGGGGGGTCAGCCCCCTGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGTGGGGGGGGTCAGCCCCCCGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGTGGGGGGATCAGCCCCCTGCCTGGCCAGCCGCCCCGTCCGGGAGGTGAGGGGCGCCTCTGCCCGGCCGCCCCTACTGGGAAGTGAGGACCCCTCTGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGTGGGGGGGTCAGCCCCCCGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGTGGGGGGATCAGCCCCCTGCCTGGCCAGCCGCCCCGTCCGGGAGGTGAGGGGCGCCTCTGCCCGGCCGCCCCTACTGGGAAGTGAGGACCCCTCTGCCCGGCCAGCCGCCCCGTCCGGGAGGGAGGTGGGGGGAACAGTCCCCCGCCCGGCCAGCCGCCCTATCCAGGAGGTGAGGGGCGCCTCTGCCCGGCCGCCCCTACTGGGAAGTGAGGAGCCCCTCTGCCTGGCCAGCCGCCCCGTCCGGGAGGGCGGTGGGGGGGTCAGCCCCCCTCCCGGCCAGCCGCCCCATCTGGGAGGTGAGGGGCACTTCTGCCGGGCCGCCCCTACTGGGAAGTGAGGAGCCCCTCTGCCCGGCCACGACCCCGTCTGGGAGGTGTGCCCAGCGGCTCATTGGGGATGGGCCATGATGACAATGGCGGTTTTGTGGAATAGAAGGGCGGGAAGGGTGGGGAAAAAATTGAGAAATCGGATGGTTGCGGGGTCTGTGTGGATAGAAGTAGACATGGGAGACTTTTCATTTTGTTCTGTACTAAGAAAAATTCTTCTGCCTTGGGATCCTGTTGATCTGTGACCTTATCCCCAACCCTGTGCTCTCTGAAACATGTGCTGTGTCCACTCAGGGTTAGATGGATTGAGGGCGGTGCAAGATGTGCTTTGTTAAACAGATGCTTGAAGGCAGCATGCTCGTTAAGAGTCATCACCACTCCCTAATCTTAAGTACCCAGGGACACAAACACTGCGGAAGGCCGCAGGGTCCTCTGCCTAGGAAAACCAGAGACCTTTGTTCACTTGTTTATCTGCTGACCTTCCCTCCACTATTGTCCTATGACCCTGCCAAATCCCCCTCTGCGAGAAACACCCAAGAATGATCAATAAAAATAAAAAATAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAA	C	.	PASS	.
chr6	30017300	.	TCCATAACTGCTGCTTTCCTGGTACCAGGGAGAACAGGTTTCCTATCAAGGACTGGGTA	T	.	PASS	.
chr6	30017546	.	CA	C	.	PASS	.
chr6	30017693	.	TG	T	.	PASS	.



> HLA_DRB1
GRanges object with 100 ranges and 5 metadata columns:
                        seqnames               ranges strand | paramRangeID
                           <Rle>            <IRanges>  <Rle> |     <factor>
     chr6:32585613_A/AT     chr6 [32585613, 32585613]      * |         <NA>
      chr6:32585669_G/A     chr6 [32585669, 32585669]      * |         <NA>
      chr6:32585698_A/T     chr6 [32585698, 32585698]      * |         <NA>
      chr6:32585731_A/G     chr6 [32585731, 32585731]      * |         <NA>
      chr6:32585754_C/G     chr6 [32585754, 32585754]      * |         <NA>
                    ...      ...                  ...    ... .          ...
      chr6:32587286_G/T     chr6 [32587286, 32587286]      * |         <NA>
     chr6:32587298_CT/C     chr6 [32587298, 32587299]      * |         <NA>
     chr6:32587307_AG/A     chr6 [32587307, 32587308]      * |         <NA>
      chr6:32587314_G/A     chr6 [32587314, 32587314]      * |         <NA>
  chr6:32587343_CAG/CTA     chr6 [32587343, 32587345]      * |         <NA>
                                   REF                ALT      QUAL      FILTER
                        <DNAStringSet> <DNAStringSetList> <numeric> <character>
     chr6:32585613_A/AT              A                 AT      <NA>        PASS
      chr6:32585669_G/A              G                  A      <NA>        PASS
      chr6:32585698_A/T              A                  T      <NA>        PASS
      chr6:32585731_A/G              A                  G      <NA>        PASS
      chr6:32585754_C/G              C                  G      <NA>        PASS
                    ...            ...                ...       ...         ...
      chr6:32587286_G/T              G                  T      <NA>        PASS
     chr6:32587298_CT/C             CT                  C      <NA>        PASS
     chr6:32587307_AG/A             AG                  A      <NA>        PASS
      chr6:32587314_G/A              G                  A      <NA>        PASS
  chr6:32587343_CAG/CTA            CAG                CTA      <NA>        PASS
  -------
  seqinfo: 1 sequence from hg19 genome
> 

######
######


>>> from Bio import SeqIO
>>> input = 'chr6_HLA_DRB1_GRCh382.fa'
>>> output = 'chr6_HLA_DRB1_GRCh38_correct.fa'  
>>> ls 




>>> from Bio import SeqIO
>>> input = 'chr6_HLA_DRB1_GRCh38_2.fa'
>>> output = 'chr6_HLA_A_GRCh38_correct.fa'
>>> SeqIO.convert(input, "fasta", output, "fasta")
1



chr6_HLA_A.fa 
chr6_HLA_DRB1_GRCh38_corrected.fa 



####
####
      

bash: chr6_HLA_DRB1_GRCh38_corrected.fa: command not found...
-bash:mskilab01:~/vg_test_VCF_original/MHC_LRC_pruning/HLA_A_vs_HLA_DRB1 1096 $ pwd
/gpfs/commons/home/biederstedte-934/vg_test_VCF_original/MHC_LRC_pruning/HLA_A_vs_HLA_DRB1

                
### HLA-A

vg construct -r  chr6_HLA_A.fa -v HLA_A_chr6.vcf > HLA_A_chr6_only.vg

vg index -x HLA_A_chr6_only.xg -g HLA_A_chr6_only.gcsa -k 16 HLA_A_chr6_only.vg



## HLA-DRB1

vg construct -r chr6_HLA_DRB1_GRCh38_corrected.fa  -v HLA_DRB1_chr6.vcf > HLA_DRB1_chr6_only.vg

vg index -x HLA_DRB1_chr6_only.xg -g HLA_DRB1_chr6_only.gcsa -k 16 HLA_DRB1_chr6_only.vg



####
####  28 March 2018

vg view -dp HLA_DRB1_chr6_only.vg | dot -Tsvg -o HLA_DRB1_chr6_only_dp.svg

vg view -dn HLA_DRB1_chr6_only.vg | dot -Tsvg -o HLA_DRB1_chr6_only_dn.svg    

vg view -dw HLA_DRB1_chr6_only.vg | dot -Tsvg -o HLA_DRB1_chr6_only_dw.svg                 

vg view -dpn HLA_DRB1_chr6_only.vg | dot -Tsvg -o HLA_DRB1_chr6_only_dpn.svg  



vg view -dp HLA_A_chr6_only.vg  | dot -Tsvg -o HLA_A_chr6_only_dp.svg

vg view -dn HLA_A_chr6_only.vg  | dot -Tsvg -o HLA_A_chr6_only_dn.svg    

vg view -dw HLA_A_chr6_only.vg | dot -Tsvg -o HLA_A_chr6_only_dw.svg                 

vg view -dpn HLA_A_chr6_only.vg | dot -Tsvg -o HLA_A_chr6_only_dpn.svg  


